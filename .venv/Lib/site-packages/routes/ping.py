from fastapi import APIRouter, Depends, HTTPException
from src.db import get_db  # This now works correctly

router = APIRouter()


@router.get("/ping")
async def ping(db=Depends(get_db)):
    try:
        result = await db.command("ping")
        return {"message": "Ping successful", "db_response": result}
    except Exception as e:
        raise HTTPException(status_code=500, detail=f"Failed to ping MongoDB: {str(e)}")
